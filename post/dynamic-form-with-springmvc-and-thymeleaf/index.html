<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.30.2" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>dynamic form with springmvc and thymeleaf &middot; Sting&#39;s Note</title>

  
  <link rel="stylesheet" href="https://stingh711.github.io/css/print.css" media="print">
  <link rel="stylesheet" href="https://stingh711.github.io/css/poole.css">
  <link rel="stylesheet" href="https://stingh711.github.io/css/syntax.css">
  <link rel="stylesheet" href="https://stingh711.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Sting&#39;s Note" />
</head>

  <body class=" ">
  <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://stingh711.github.io/"><h1>Sting&#39;s Note</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="https://stingh711.github.io/">Home</a> </li>
      <li><a href="/post/pandas-in-jupyter/"> Pandas in jupyter </a></li>
    </ul>

    <p>&copy; 2017. All rights reserved. </p>
  </div>
</div>

    <div class="content container">
    <div class="post">
  <h1>dynamic form with springmvc and thymeleaf</h1>
  <span class="post-date">Fri, Aug 1, 2014</span>
  

<h2 id="requirements">Requirements</h2>

<p>SubjectGroup and SubjectGroupOption has one-to-many relationship. When adding a subject group, subject group options can be added inline.</p>

<h2 id="things-i-ve-learned">Things I’ve learned.</h2>

<ul>
<li>When adding an option, don’t need to use javascript to handle the added html snippet. Just submit the add request to controller and handle the adding in the controller (Add a new options into the option list of subject group), then return to the add page. Spring mvc’s data binding and thyme leaf’s for loop will handle the html. (In EDC, I use javascript to append option html. It works. But there are some duplicate codes in JSP and javascript)</li>
<li>Can use the same way to handle subject option removing.</li>
<li>If there are multiple submit button in one form. We can use button’s name to separate them. In controller, use RequestMapping’s params to make the submit request to the right controller method.</li>
</ul>

<h2 id="code">Code</h2>

<p>SubjectGroupController.java</p>

<pre><code class="language-java">package edc.web;

import edc.model.SubjectGroup;
import edc.model.SubjectGroupOption;
import edc.service.SubjectGroupService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping(&quot;/sg&quot;)
public class SubjectGroupController {
    private SubjectGroupService subjectGroupService;

    @Autowired
    public void setSubjectGroupService(SubjectGroupService subjectGroupService) {
        this.subjectGroupService = subjectGroupService;
    }

    @RequestMapping(value = &quot;add&quot;)
    public String add(SubjectGroup subjectGroup) {
        return &quot;subjectGroup/add&quot;;
    }

    @RequestMapping(value = &quot;add&quot;, params = {&quot;addOption&quot;})
    public String addOption(SubjectGroup subjectGroup, BindingResult result) {
        subjectGroup.getOptions().add(new SubjectGroupOption());
        return &quot;subjectGroup/add&quot;;
    }

    @RequestMapping(value = &quot;add&quot;, method = RequestMethod.POST)
    public String save(SubjectGroup subjectGroup, BindingResult result) {
        this.subjectGroupService.save(subjectGroup);
        return &quot;redirect:/sg/add&quot;;
    }
}

</code></pre>

<p>add.html</p>

<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;section&gt;
    &lt;h2&gt;Add Subject Group&lt;/h2&gt;
    &lt;form action=&quot;#&quot; th:action=&quot;@{/sg/add}&quot; th:object=&quot;${subjectGroup}&quot; method=&quot;POST&quot;&gt;
      &lt;p&gt;&lt;input type=&quot;text&quot; th:field=&quot;*{name}&quot; placeholder=&quot;Name...&quot;/&gt;&lt;/p&gt;
        &lt;h3&gt;Options&lt;/h3&gt;
        &lt;button type=&quot;submit&quot; name=&quot;addOption&quot;&gt;Add Option&lt;/button&gt;
        &lt;table&gt;
            &lt;tr th:each=&quot;option, rowStat : *{options}&quot;&gt;
              &lt;td&gt;&lt;input type=&quot;text&quot; th:field=&quot;*{options[__${rowStat.index}__].label}&quot; placeholder=&quot;Option...&quot;/&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;button type=&quot;submit&quot;&gt;Add&lt;/button&gt;
    &lt;/form&gt;
&lt;/section&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

</div>

<h2>Comments</h2>
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "stingh711" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-10412053-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

  </body>
</html>